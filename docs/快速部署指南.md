# ðŸš€ å¿«é€Ÿéƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—æä¾›æœ€å¿«é€Ÿçš„éƒ¨ç½²æ–¹å¼ï¼Œé€‚åˆå¿«é€Ÿä¸Šæ‰‹å’Œæµ‹è¯•ã€‚

## æ–¹å¼ä¸€ï¼šDocker Composeï¼ˆæœ€ç®€å•ï¼Œ5åˆ†é’Ÿæžå®šï¼‰

### 1. å®‰è£… Docker

```bash
# Ubuntu/Debian
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# CentOS/RHEL
sudo yum install -y docker
sudo systemctl start docker
sudo systemctl enable docker
```

### 2. å®‰è£… Docker Compose

```bash
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

### 3. å…‹éš†é¡¹ç›®å¹¶é…ç½®

```bash
# å…‹éš†é¡¹ç›®ï¼ˆå‡è®¾æ‚¨å·²æœ‰é¡¹ç›®ä»£ç ï¼‰
cd /path/to/sdk-platform

# åˆ›å»ºçŽ¯å¢ƒå˜é‡æ–‡ä»¶
cat > server/.env << EOF
PORT=3000
NODE_ENV=production
DB_HOST=mysql
DB_PORT=3306
DB_USER=analytics_user
DB_PASSWORD=analytics_password
DB_NAME=analytics_platform
DB_POOL_LIMIT=20
JWT_SECRET=your_jwt_secret_change_me
OPENAI_API_KEY=sk-your-key-here
OPENAI_MODEL=gpt-3.5-turbo
ML_SERVICE_URL=http://ml-service:5000
EOF

cat > ml-service/.env << EOF
ML_SERVICE_PORT=5000
FLASK_DEBUG=False
EOF
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

### 5. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç­‰å¾…MySQLå¯åŠ¨å®Œæˆï¼ˆçº¦10ç§’ï¼‰
sleep 10

# åˆå§‹åŒ–æ•°æ®åº“
docker-compose exec backend node dist/init-database.js
```

### 6. è®¿é—®åº”ç”¨

- ðŸŒ å‰ç«¯: http://localhost
- ðŸ“š APIæ–‡æ¡£: http://localhost/api/docs
- ðŸ”Œ åŽç«¯API: http://localhost/api

---

## æ–¹å¼äºŒï¼šä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆä¼ ç»Ÿéƒ¨ç½²ï¼‰

### 1. å‡†å¤‡æœåŠ¡å™¨

```bash
# å®‰è£…Node.js 18
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
source ~/.bashrc
nvm install 18
nvm use 18

# å®‰è£…pnpm
npm install -g pnpm

# å®‰è£…PM2
npm install -g pm2

# å®‰è£…MySQL
sudo apt install mysql-server -y  # Ubuntu
# æˆ–
sudo yum install mysql-server -y  # CentOS

# å®‰è£…Nginx
sudo apt install nginx -y  # Ubuntu
# æˆ–
sudo yum install nginx -y  # CentOS
```

### 2. é…ç½®æ•°æ®åº“

```bash
# ç™»å½•MySQL
sudo mysql -u root -p

# åˆ›å»ºæ•°æ®åº“
CREATE DATABASE analytics_platform CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'analytics_user'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON analytics_platform.* TO 'analytics_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

### 3. é…ç½®çŽ¯å¢ƒå˜é‡

```bash
# å¤åˆ¶æ¨¡æ¿æ–‡ä»¶
cp server/.env.example server/.env

# ç¼–è¾‘çŽ¯å¢ƒå˜é‡ï¼ˆå¡«å…¥å®žé™…å€¼ï¼‰
nano server/.env
```

### 4. è¿è¡Œéƒ¨ç½²è„šæœ¬

```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x deploy.sh

# è¿è¡Œéƒ¨ç½²
bash deploy.sh production
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… å®‰è£…ä¾èµ–
- âœ… æž„å»ºå‰ç«¯å’ŒåŽç«¯
- âœ… åˆå§‹åŒ–æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰
- âœ… å¯åŠ¨æ‰€æœ‰æœåŠ¡

### 5. é…ç½®Nginx

å‚è€ƒ `docs/é¡¹ç›®éƒ¨ç½²æŒ‡å—.md` ä¸­çš„ Nginx é…ç½®éƒ¨åˆ†ã€‚

---

## æ–¹å¼ä¸‰ï¼šæ‰‹åŠ¨éƒ¨ç½²ï¼ˆå®Œå…¨æŽ§åˆ¶ï¼‰

è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒ `docs/é¡¹ç›®éƒ¨ç½²æŒ‡å—.md`ã€‚

---

## ðŸ” éªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status  # å¦‚æžœä½¿ç”¨PM2
# æˆ–
docker-compose ps  # å¦‚æžœä½¿ç”¨Docker

# æµ‹è¯•API
curl http://localhost/api/health  # å¦‚æžœæœ‰å¥åº·æ£€æŸ¥ç«¯ç‚¹

# æŸ¥çœ‹æ—¥å¿—
pm2 logs  # PM2æ–¹å¼
# æˆ–
docker-compose logs -f  # Dockeræ–¹å¼
```

---

## ðŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### Docker Compose

```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# åœæ­¢æœåŠ¡
docker-compose down

# é‡å¯æœåŠ¡
docker-compose restart

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f [service_name]

# è¿›å…¥å®¹å™¨
docker-compose exec backend sh
docker-compose exec mysql mysql -u root -p
```

### PM2

```bash
# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs

# é‡å¯æœåŠ¡
pm2 restart all

# åœæ­¢æœåŠ¡
pm2 stop all

# åˆ é™¤æœåŠ¡
pm2 delete all
```

---

## â“ é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹æ—¥å¿—**: 
   - Docker: `docker-compose logs -f`
   - PM2: `pm2 logs`

2. **æ£€æŸ¥ç«¯å£å ç”¨**:
   ```bash
   sudo netstat -tlnp | grep -E ':(3000|5000|80|3306)'
   ```

3. **æ£€æŸ¥æ•°æ®åº“è¿žæŽ¥**:
   ```bash
   mysql -u analytics_user -p analytics_platform
   ```

4. **è¯¦ç»†é—®é¢˜æŽ’æŸ¥**: å‚è€ƒ `docs/é¡¹ç›®éƒ¨ç½²æŒ‡å—.md` ä¸­çš„"å¸¸è§é—®é¢˜"éƒ¨åˆ†

---

## ðŸ“ ä¸‹ä¸€æ­¥

- âœ… é…ç½®åŸŸåå’ŒHTTPS
- âœ… è®¾ç½®è‡ªåŠ¨å¤‡ä»½
- âœ… é…ç½®ç›‘æŽ§å‘Šè­¦
- âœ… ä¼˜åŒ–æ€§èƒ½

è¯¦ç»†å†…å®¹è¯·å‚è€ƒå®Œæ•´çš„ `docs/é¡¹ç›®éƒ¨ç½²æŒ‡å—.md`

