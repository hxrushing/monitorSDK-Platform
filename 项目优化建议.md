# é¡¹ç›®ä¼˜åŒ–å»ºè®®

åŸºäºä»£ç å®¡æŸ¥ï¼Œä»¥ä¸‹æ˜¯é’ˆå¯¹è¯¥åŸ‹ç‚¹åˆ†æå¹³å°çš„ä¼˜åŒ–å»ºè®®ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åºã€‚

## âœ… å·²å®Œæˆçš„ä¼˜åŒ–

### 1. Dashboardç»„ä»¶æ€§èƒ½ä¼˜åŒ–
- âœ… ä¿®å¤äº†`useEffect`ä¾èµ–é¡¹é—®é¢˜ï¼Œä½¿ç”¨`useCallback`åŒ…è£…`fetchData`
- âœ… ä½¿ç”¨`useMemo`ä¼˜åŒ–å›¾è¡¨æ•°æ®è®¡ç®—ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ–°è®¡ç®—
- âœ… ä½¿ç”¨`useCallback`ä¼˜åŒ–äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œé¿å…å­ç»„ä»¶ä¸å¿…è¦çš„é‡æ¸²æŸ“
- âœ… ä¼˜åŒ–äº†ç»Ÿè®¡æ•°æ®çš„è®¡ç®—ï¼Œä½¿ç”¨`useMemo`ç¼“å­˜ç»“æœ

### 2. æ–°å¢é€šç”¨Hooks
- âœ… åˆ›å»ºäº†`useRequest` Hookï¼Œå°è£…è¯·æ±‚é€»è¾‘ï¼ˆåŠ è½½çŠ¶æ€ã€é”™è¯¯å¤„ç†ã€ç¼“å­˜ã€å»é‡ç­‰ï¼‰
- âœ… åˆ›å»ºäº†`useDebounce`å’Œ`useDebounceFn` Hookï¼Œç”¨äºé˜²æŠ–å¤„ç†

### 3. é”™è¯¯è¾¹ç•Œ
- âœ… åˆ›å»ºäº†`ErrorBoundary`ç»„ä»¶ï¼Œç”¨äºæ•è·Reactç»„ä»¶æ ‘ä¸­çš„é”™è¯¯

### 4. è·¯ç”±åŠ è½½çŠ¶æ€ä¼˜åŒ–
- âœ… åˆ›å»ºäº†`RouteLoading`ç»„ä»¶ï¼Œæä¾›ç¾è§‚çš„è·¯ç”±åŠ è½½ç•Œé¢ï¼ˆæ¸å˜èƒŒæ™¯ã€åŠ¨ç”»æ•ˆæœã€æ¯›ç»ç’ƒæ•ˆæœï¼‰
- âœ… åˆ›å»ºäº†`PageLoading`ç»„ä»¶ï¼Œç”¨äºé€šç”¨é¡µé¢åŠ è½½
- âœ… åˆ›å»ºäº†`ChartLoading`ç»„ä»¶ï¼Œä¸“é—¨ç”¨äºå›¾è¡¨åŠ è½½
- âœ… æ›´æ–°äº†è·¯ç”±é…ç½®ï¼Œä½¿ç”¨æ–°çš„åŠ è½½ç»„ä»¶æ›¿ä»£ç®€å•çš„"åŠ è½½ä¸­..."æ–‡å­—
- âœ… ä¼˜åŒ–äº†Dashboardä¸­çš„å›¾è¡¨åŠ è½½çŠ¶æ€

---

## ğŸš€ å»ºè®®ç»§ç»­ä¼˜åŒ–çš„ç‚¹

### 1. åœ¨åº”ç”¨ä¸­ä½¿ç”¨ErrorBoundaryï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰âœ… å·²å®Œæˆ

**é—®é¢˜**ï¼šç›®å‰æ²¡æœ‰å…¨å±€é”™è¯¯è¾¹ç•Œï¼Œç»„ä»¶é”™è¯¯ä¼šå¯¼è‡´æ•´ä¸ªåº”ç”¨å´©æºƒã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
å·²å®ç°ä¸¤å±‚é”™è¯¯è¾¹ç•Œä¿æŠ¤ï¼š

1. **å…¨å±€é”™è¯¯è¾¹ç•Œ**ï¼ˆ`src/main.tsx`ï¼‰ï¼š
   - åœ¨åº”ç”¨æœ€å¤–å±‚åŒ…è£¹ `ErrorBoundary`
   - æ•è·æ‰€æœ‰ç»„ä»¶æ¸²æŸ“é”™è¯¯
   - é˜²æ­¢æ•´ä¸ªåº”ç”¨å´©æºƒ

2. **è·¯ç”±é”™è¯¯è¾¹ç•Œ**ï¼ˆ`src/router/index.tsx`ï¼‰ï¼š
   - åˆ›å»ºäº† `RouteErrorBoundary` ç»„ä»¶
   - åœ¨æ‰€æœ‰è·¯ç”±ä¸­æ·»åŠ  `errorElement`
   - å¤„ç†è·¯ç”±çº§åˆ«çš„é”™è¯¯ï¼ˆ404ã€500ã€åŠ è½½é”™è¯¯ç­‰ï¼‰

**å®ç°ä½ç½®ï¼š**
- `src/main.tsx` - å…¨å±€ErrorBoundary
- `src/components/RouteErrorBoundary.tsx` - è·¯ç”±é”™è¯¯å¤„ç†ç»„ä»¶
- `src/router/index.tsx` - æ‰€æœ‰è·¯ç”±çš„errorElement

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- âœ… æ•è·ç»„ä»¶æ¸²æŸ“é”™è¯¯
- âœ… æ•è·è·¯ç”±åŠ è½½é”™è¯¯
- âœ… å‹å¥½çš„é”™è¯¯æç¤ºç•Œé¢
- âœ… å¼€å‘ç¯å¢ƒæ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
- âœ… æä¾›è¿”å›é¦–é¡µå’Œé‡è¯•åŠŸèƒ½
- âœ… åŒºåˆ†404ã€500ç­‰ä¸åŒé”™è¯¯ç±»å‹

**æ”¶ç›Š**ï¼š
- âœ… é˜²æ­¢å•ä¸ªç»„ä»¶é”™è¯¯å¯¼è‡´æ•´ä¸ªåº”ç”¨å´©æºƒ
- âœ… æä¾›å‹å¥½çš„é”™è¯¯æç¤ºç•Œé¢
- âœ… å¼€å‘ç¯å¢ƒæ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
- âœ… è·¯ç”±çº§åˆ«çš„é”™è¯¯ä¹Ÿèƒ½è¢«æ­£ç¡®å¤„ç†

---

### 2. ä½¿ç”¨useRequest Hooké‡æ„APIè°ƒç”¨ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

**é—®é¢˜**ï¼šå„ä¸ªç»„ä»¶ä¸­éƒ½æœ‰é‡å¤çš„è¯·æ±‚é€»è¾‘ï¼ˆloadingçŠ¶æ€ã€é”™è¯¯å¤„ç†ç­‰ï¼‰ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
åœ¨Dashboardç»„ä»¶ä¸­ä½¿ç”¨æ–°çš„`useRequest` Hookï¼š

```typescript
// src/pages/Dashboard/index.tsx
import { useRequest } from '@/hooks/useRequest';

const Dashboard: React.FC = () => {
  const selectedProjectId = useGlobalStore(state => state.selectedProjectId);
  const [dateRange, setDateRange] = useState<[dayjs.Dayjs, dayjs.Dayjs]>([...]);

  // ä½¿ç”¨useRequestæ›¿ä»£æ‰‹åŠ¨ç®¡ç†loadingå’Œerror
  const { data: statsData = [], loading: statsLoading, refresh: refreshStats } = useRequest(
    () => apiService.getStats({
      projectId: selectedProjectId,
      startDate: dateRange[0].format('YYYY-MM-DD'),
      endDate: dateRange[1].format('YYYY-MM-DD')
    }),
    {
      cacheTime: 60000, // ç¼“å­˜1åˆ†é’Ÿ
      dedupe: true, // å»é‡
    }
  );

  const { data: overview = defaultOverview, loading: overviewLoading } = useRequest(
    () => apiService.getDashboardOverview(selectedProjectId),
    { cacheTime: 30000 }
  );
  
  // å½“dateRangeæˆ–selectedProjectIdå˜åŒ–æ—¶ï¼Œè‡ªåŠ¨åˆ·æ–°
  useEffect(() => {
    refreshStats();
  }, [dateRange, selectedProjectId]);
}
```

**æ”¶ç›Š**ï¼š
- å‡å°‘é‡å¤ä»£ç 
- ç»Ÿä¸€é”™è¯¯å¤„ç†
- æ”¯æŒè¯·æ±‚ç¼“å­˜å’Œå»é‡
- è‡ªåŠ¨ç®¡ç†loadingçŠ¶æ€

---

### 3. æ·»åŠ è¯·æ±‚é‡è¯•æœºåˆ¶ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

**é—®é¢˜**ï¼šç½‘ç»œä¸ç¨³å®šæ—¶ï¼Œè¯·æ±‚å¤±è´¥åéœ€è¦ç”¨æˆ·æ‰‹åŠ¨é‡è¯•ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
åœ¨`src/utils/http.ts`ä¸­æ·»åŠ è¯·æ±‚é‡è¯•é€»è¾‘ï¼š

```typescript
// src/utils/http.ts
import axios, { AxiosError, InternalAxiosRequestConfig } from 'axios';

// é‡è¯•é…ç½®
const MAX_RETRIES = 3;
const RETRY_DELAY = 1000; // 1ç§’

// å“åº”æ‹¦æˆªå™¨ - æ·»åŠ é‡è¯•é€»è¾‘
instance.interceptors.response.use(
  response => response.data,
  async (error: AxiosError) => {
    const config = error.config as InternalAxiosRequestConfig & { __retryCount?: number };
    
    // åˆå§‹åŒ–é‡è¯•æ¬¡æ•°
    config.__retryCount = config.__retryCount || 0;
    
    // åˆ¤æ–­æ˜¯å¦éœ€è¦é‡è¯•
    if (shouldRetry(error) && config.__retryCount < MAX_RETRIES) {
      config.__retryCount += 1;
      
      // å»¶è¿Ÿé‡è¯•
      await new Promise(resolve => setTimeout(resolve, RETRY_DELAY * config.__retryCount));
      
      return instance.request(config);
    }
    
    // åŸæœ‰é”™è¯¯å¤„ç†é€»è¾‘
    const status = error?.response?.status;
    if (status === 401) {
      localStorage.removeItem('token');
      localStorage.removeItem('userInfo');
      if (window.location.pathname !== '/login') {
        window.location.href = '/login';
      }
    }
    
    return Promise.reject(error);
  }
);

// åˆ¤æ–­æ˜¯å¦åº”è¯¥é‡è¯•
function shouldRetry(error: AxiosError): boolean {
  // ç½‘ç»œé”™è¯¯æˆ–è¶…æ—¶é”™è¯¯æ‰é‡è¯•
  if (!error.response) {
    return true; // ç½‘ç»œé”™è¯¯
  }
  
  // 5xxé”™è¯¯é‡è¯•
  const status = error.response.status;
  return status >= 500 && status < 600;
}
```

**æ”¶ç›Š**ï¼š
- æé«˜ç½‘ç»œä¸ç¨³å®šæ—¶çš„è¯·æ±‚æˆåŠŸç‡
- å‡å°‘ç”¨æˆ·æ‰‹åŠ¨é‡è¯•çš„æ“ä½œ

---

### 4. æ·»åŠ è¯·æ±‚ç¼“å­˜ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

**é—®é¢˜**ï¼šç›¸åŒå‚æ•°çš„è¯·æ±‚ä¼šé‡å¤å‘é€ï¼Œæµªè´¹èµ„æºã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
åœ¨`useRequest` Hookä¸­å·²ç»å®ç°äº†ç¼“å­˜åŠŸèƒ½ï¼Œä½†å¯ä»¥åœ¨APIå±‚é¢ä¹Ÿæ·»åŠ ç¼“å­˜ï¼š

```typescript
// src/utils/http.ts
import { AxiosRequestConfig } from 'axios';

// ç®€å•çš„å†…å­˜ç¼“å­˜
const requestCache = new Map<string, { data: any; timestamp: number }>();
const CACHE_TIME = 60000; // 1åˆ†é’Ÿ

// è¯·æ±‚æ‹¦æˆªå™¨ - æ£€æŸ¥ç¼“å­˜
instance.interceptors.request.use((config) => {
  // åªæœ‰GETè¯·æ±‚æ‰ç¼“å­˜
  if (config.method?.toLowerCase() === 'get' && config.params) {
    const cacheKey = `${config.url}?${JSON.stringify(config.params)}`;
    const cached = requestCache.get(cacheKey);
    
    if (cached && Date.now() - cached.timestamp < CACHE_TIME) {
      // è¿”å›ç¼“å­˜çš„å“åº”
      return Promise.reject({
        __isCache: true,
        data: cached.data,
      });
    }
  }
  
  return config;
});

// å“åº”æ‹¦æˆªå™¨ - ä¿å­˜ç¼“å­˜
instance.interceptors.response.use(
  (response) => {
    const config = response.config;
    if (config.method?.toLowerCase() === 'get' && config.params) {
      const cacheKey = `${config.url}?${JSON.stringify(config.params)}`;
      requestCache.set(cacheKey, {
        data: response.data,
        timestamp: Date.now(),
      });
    }
    return response.data;
  },
  // ... é”™è¯¯å¤„ç†
);
```

**æ”¶ç›Š**ï¼š
- å‡å°‘é‡å¤è¯·æ±‚
- æå‡ç”¨æˆ·ä½“éªŒï¼ˆå¿«é€Ÿå“åº”ï¼‰
- å‡å°‘æœåŠ¡å™¨å‹åŠ›

---

### 5. ä¼˜åŒ–è·¯ç”±åŠ è½½çŠ¶æ€ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰âœ… å·²å®Œæˆ

**é—®é¢˜**ï¼šè·¯ç”±æ‡’åŠ è½½æ—¶ï¼Œfallbackåªæ˜¯ä¸€ä¸ªç®€å•çš„"åŠ è½½ä¸­..."æ–‡å­—ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
å·²åˆ›å»ºç»Ÿä¸€çš„åŠ è½½ç»„ä»¶ç³»ç»Ÿï¼š

1. **RouteLoadingç»„ä»¶**ï¼šä¸“é—¨ç”¨äºè·¯ç”±åŠ è½½ï¼ŒåŒ…å«ï¼š
   - æ¸å˜èƒŒæ™¯å’ŒåŠ¨ç”»æ•ˆæœ
   - æ¯›ç»ç’ƒæ•ˆæœï¼ˆbackdrop-filterï¼‰
   - æ”¯æŒæ˜æš—ä¸»é¢˜
   - å‹å¥½çš„åŠ è½½æç¤º

2. **PageLoadingç»„ä»¶**ï¼šé€šç”¨é¡µé¢åŠ è½½ç»„ä»¶ï¼Œå¯é…ç½®å…¨å±æˆ–å±€éƒ¨åŠ è½½

3. **ChartLoadingç»„ä»¶**ï¼šä¸“é—¨ç”¨äºå›¾è¡¨ç»„ä»¶çš„æ‡’åŠ è½½

**å®ç°ä½ç½®**ï¼š
- `src/components/Loading/RouteLoading.tsx` - è·¯ç”±åŠ è½½ç»„ä»¶
- `src/components/Loading/PageLoading.tsx` - é¡µé¢åŠ è½½ç»„ä»¶
- `src/components/Loading/ChartLoading.tsx` - å›¾è¡¨åŠ è½½ç»„ä»¶
- `src/router/index.tsx` - å·²æ›´æ–°ä½¿ç”¨RouteLoading

**æ”¶ç›Š**ï¼š
- âœ… ç»Ÿä¸€çš„åŠ è½½ä½“éªŒ
- âœ… æ›´å¥½çš„è§†è§‰æ•ˆæœï¼ˆæ¸å˜èƒŒæ™¯ã€åŠ¨ç”»ï¼‰
- âœ… æ”¯æŒä¸»é¢˜åˆ‡æ¢
- âœ… æå‡ç”¨æˆ·ä½“éªŒ

---

### 6. æ·»åŠ éª¨æ¶å±ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰âœ… å·²å®Œæˆ

**é—®é¢˜**ï¼šæ•°æ®åŠ è½½æ—¶ï¼Œé¡µé¢ç©ºç™½ï¼Œç”¨æˆ·ä½“éªŒä¸ä½³ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
å·²åˆ›å»ºå®Œæ•´çš„éª¨æ¶å±ç»„ä»¶ç³»ç»Ÿï¼š

1. **DashboardSkeletonç»„ä»¶**ï¼šå®Œæ•´çš„Dashboardé¡µé¢éª¨æ¶å±
   - é¡¶éƒ¨å·¥å…·æ éª¨æ¶
   - 4ä¸ªç»Ÿè®¡å¡ç‰‡éª¨æ¶
   - å›¾è¡¨å¡ç‰‡éª¨æ¶
   - è¡¨æ ¼å¡ç‰‡éª¨æ¶

2. **StatisticCardSkeletonç»„ä»¶**ï¼šå•ä¸ªç»Ÿè®¡å¡ç‰‡éª¨æ¶å±
   - å¯é…ç½®æ ‡é¢˜æ˜¾ç¤º
   - é€‚åˆç»Ÿè®¡å¡ç‰‡å¸ƒå±€

3. **TableSkeletonç»„ä»¶**ï¼šè¡¨æ ¼éª¨æ¶å±
   - å¯é…ç½®åˆ—æ•°å’Œè¡Œæ•°
   - æ”¯æŒå¡ç‰‡åŒ…è£¹

4. **ChartSkeletonç»„ä»¶**ï¼šå›¾è¡¨éª¨æ¶å±
   - å¯é…ç½®é«˜åº¦
   - é€‚åˆå›¾è¡¨å®¹å™¨

**å®ç°ä½ç½®ï¼š**
- `src/components/Skeleton/DashboardSkeleton.tsx` - Dashboardéª¨æ¶å±
- `src/components/Skeleton/StatisticCardSkeleton.tsx` - ç»Ÿè®¡å¡ç‰‡éª¨æ¶å±
- `src/components/Skeleton/TableSkeleton.tsx` - è¡¨æ ¼éª¨æ¶å±
- `src/components/Skeleton/ChartSkeleton.tsx` - å›¾è¡¨éª¨æ¶å±
- `src/pages/Dashboard/index.tsx` - å·²åº”ç”¨DashboardSkeleton

**ä½¿ç”¨é€»è¾‘ï¼š**
```tsx
// é¦–æ¬¡åŠ è½½ä¸”æ²¡æœ‰æ•°æ®æ—¶æ˜¾ç¤ºéª¨æ¶å±
if (loading && statsData.length === 0 && overview.todayPV === 0) {
  return <DashboardSkeleton />;
}

// æœ‰æ•°æ®æ—¶åˆ·æ–°ä½¿ç”¨Spiné®ç½©
return (
  <Spin spinning={loading}>
    <DashboardContent />
  </Spin>
);
```

**æ”¶ç›Š**ï¼š
- âœ… æå‡ç”¨æˆ·ä½“éªŒï¼ˆæ˜¾ç¤ºé¡µé¢ç»“æ„ï¼Œè€Œéç©ºç™½ï¼‰
- âœ… å‡å°‘æ„ŸçŸ¥åŠ è½½æ—¶é—´
- âœ… ç»Ÿä¸€çš„åŠ è½½ä½“éªŒ
- âœ… ç¬¦åˆç°ä»£Webåº”ç”¨æœ€ä½³å®è·µ

---

### 7. ä½¿ç”¨React.memoä¼˜åŒ–ç»„ä»¶ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

**é—®é¢˜**ï¼šæŸäº›ç»„ä»¶åœ¨çˆ¶ç»„ä»¶æ›´æ–°æ—¶ä¼šä¸å¿…è¦åœ°é‡æ–°æ¸²æŸ“ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
å¯¹çº¯å±•ç¤ºç»„ä»¶ä½¿ç”¨`React.memo`ï¼š

```typescript
// src/components/StatisticCard.tsx
import React, { memo } from 'react';
import { Card, Statistic } from 'antd';

interface StatisticCardProps {
  title: string;
  value: number;
  suffix?: string;
  icon?: React.ReactNode;
}

const StatisticCard: React.FC<StatisticCardProps> = memo(({ title, value, suffix, icon }) => {
  return (
    <Card>
      <Statistic
        title={title}
        value={value}
        suffix={suffix}
        prefix={icon}
      />
    </Card>
  );
});

StatisticCard.displayName = 'StatisticCard';

export default StatisticCard;
```

**æ”¶ç›Š**ï¼š
- å‡å°‘ä¸å¿…è¦çš„é‡æ¸²æŸ“
- æå‡æ€§èƒ½

---

### 8. æ·»åŠ TypeScriptä¸¥æ ¼æ¨¡å¼ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

**é—®é¢˜**ï¼šTypeScripté…ç½®å¯èƒ½ä¸å¤Ÿä¸¥æ ¼ï¼Œå…è®¸`any`ç±»å‹ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
åœ¨`tsconfig.json`ä¸­å¯ç”¨ä¸¥æ ¼æ£€æŸ¥ï¼š

```json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true
  }
}
```

**æ”¶ç›Š**ï¼š
- æ›´å¥½çš„ç±»å‹å®‰å…¨
- å‡å°‘è¿è¡Œæ—¶é”™è¯¯

---

### 9. æ·»åŠ å•å…ƒæµ‹è¯•ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

**é—®é¢˜**ï¼šç¼ºå°‘å•å…ƒæµ‹è¯•ï¼Œä»£ç è´¨é‡éš¾ä»¥ä¿è¯ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
ä½¿ç”¨Vitest + React Testing Libraryï¼š

```typescript
// src/utils/dataSampling.test.ts
import { describe, it, expect } from 'vitest';
import { lttbSampling } from './dataSampling';

describe('lttbSampling', () => {
  it('should return original data if length <= maxPoints', () => {
    const data = [{ date: '2024-01-01', value: 100 }];
    expect(lttbSampling(data, 1000)).toEqual(data);
  });
  
  it('should sample data correctly', () => {
    const data = Array.from({ length: 1000 }, (_, i) => ({
      date: `2024-01-${String(i + 1).padStart(2, '0')}`,
      value: i,
    }));
    const sampled = lttbSampling(data, 100);
    expect(sampled.length).toBe(100);
  });
});
```

**æ”¶ç›Š**ï¼š
- ä¿è¯ä»£ç è´¨é‡
- é˜²æ­¢å›å½’é—®é¢˜

---

### 10. ä¼˜åŒ–æ„å»ºé…ç½®ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

**é—®é¢˜**ï¼šæ„å»ºé…ç½®å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
åœ¨`vite.config.ts`ä¸­æ·»åŠ æ›´å¤šä¼˜åŒ–ï¼š

```typescript
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          'react-vendor': ['react', 'react-dom', 'react-router-dom'],
          'antd-vendor': ['antd', '@ant-design/icons'],
          'charts-vendor': ['@ant-design/plots'],
          'utils-vendor': ['dayjs', 'lodash', 'axios'],
        },
      },
    },
    // å¯ç”¨gzipå‹ç¼©
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true, // ç”Ÿäº§ç¯å¢ƒç§»é™¤console
        drop_debugger: true,
      },
    },
    // å¯ç”¨source mapï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
    sourcemap: process.env.NODE_ENV === 'development',
  },
});
```

**æ”¶ç›Š**ï¼š
- å‡å°bundleå¤§å°
- æå‡åŠ è½½é€Ÿåº¦

---

## ğŸ“Š ä¼˜åŒ–ä¼˜å…ˆçº§æ€»ç»“

| ä¼˜å…ˆçº§ | ä¼˜åŒ–é¡¹ | é¢„è®¡å·¥ä½œé‡ | æ”¶ç›Š |
|--------|--------|-----------|------|
| ğŸ”´ é«˜ | ä½¿ç”¨ErrorBoundary | 30åˆ†é’Ÿ | é˜²æ­¢åº”ç”¨å´©æºƒ |
| ğŸ”´ é«˜ | ä½¿ç”¨useRequesté‡æ„ | 2å°æ—¶ | å‡å°‘é‡å¤ä»£ç ï¼Œç»Ÿä¸€é”™è¯¯å¤„ç† |
| ğŸŸ¡ ä¸­ | è¯·æ±‚é‡è¯•æœºåˆ¶ | 1å°æ—¶ | æé«˜è¯·æ±‚æˆåŠŸç‡ |
| ğŸŸ¡ ä¸­ | è¯·æ±‚ç¼“å­˜ | 1å°æ—¶ | å‡å°‘é‡å¤è¯·æ±‚ |
| ğŸŸ¡ ä¸­ | ä¼˜åŒ–åŠ è½½çŠ¶æ€ | 30åˆ†é’Ÿ | æå‡ç”¨æˆ·ä½“éªŒ |
| ğŸŸ¡ ä¸­ | æ·»åŠ éª¨æ¶å± | 1å°æ—¶ | æå‡ç”¨æˆ·ä½“éªŒ | âœ… å·²å®Œæˆ |
| ğŸŸ¡ ä¸­ | React.memoä¼˜åŒ– | 2å°æ—¶ | æå‡æ€§èƒ½ |
| ğŸŸ¢ ä½ | TypeScriptä¸¥æ ¼æ¨¡å¼ | 4å°æ—¶ | ç±»å‹å®‰å…¨ |
| ğŸŸ¢ ä½ | å•å…ƒæµ‹è¯• | 8å°æ—¶ | ä»£ç è´¨é‡ |
| ğŸŸ¢ ä½ | æ„å»ºé…ç½®ä¼˜åŒ– | 1å°æ—¶ | æ€§èƒ½ä¼˜åŒ– |

---

## ğŸ¯ å»ºè®®å®æ–½é¡ºåº

1. **ç¬¬ä¸€é˜¶æ®µï¼ˆç«‹å³å®æ–½ï¼‰**ï¼š
   - âœ… Dashboardç»„ä»¶ä¼˜åŒ–ï¼ˆå·²å®Œæˆï¼‰
   - âœ… åˆ›å»ºé€šç”¨Hooksï¼ˆå·²å®Œæˆï¼‰
   - âœ… åˆ›å»ºErrorBoundaryï¼ˆå·²å®Œæˆï¼‰
   - âœ… ä¼˜åŒ–è·¯ç”±åŠ è½½çŠ¶æ€ï¼ˆå·²å®Œæˆï¼‰
   - âœ… æ·»åŠ éª¨æ¶å±ï¼ˆå·²å®Œæˆï¼‰
   - ğŸ”² åœ¨åº”ç”¨ä¸­ä½¿ç”¨ErrorBoundary
   - ğŸ”² ä½¿ç”¨useRequesté‡æ„Dashboard

2. **ç¬¬äºŒé˜¶æ®µï¼ˆ1å‘¨å†…ï¼‰**ï¼š
   - ğŸ”² æ·»åŠ è¯·æ±‚é‡è¯•æœºåˆ¶
   - ğŸ”² åœ¨å…¶ä»–é¡µé¢åº”ç”¨éª¨æ¶å±ï¼ˆEventAnalysisã€FunnelAnalysisç­‰ï¼‰
   - ğŸ”² ä½¿ç”¨React.memoä¼˜åŒ–å…³é”®ç»„ä»¶

3. **ç¬¬ä¸‰é˜¶æ®µï¼ˆé•¿æœŸï¼‰**ï¼š
   - ğŸ”² TypeScriptä¸¥æ ¼æ¨¡å¼
   - ğŸ”² æ·»åŠ å•å…ƒæµ‹è¯•
   - ğŸ”² æ„å»ºé…ç½®ä¼˜åŒ–

---

## ğŸ’¡ å…¶ä»–å»ºè®®

1. **ä»£ç è§„èŒƒ**ï¼š
   - è€ƒè™‘ä½¿ç”¨Prettierç»Ÿä¸€ä»£ç æ ¼å¼
   - è€ƒè™‘ä½¿ç”¨Husky + lint-stagedåœ¨æäº¤å‰æ£€æŸ¥ä»£ç 

2. **æ€§èƒ½ç›‘æ§**ï¼š
   - è€ƒè™‘é›†æˆæ€§èƒ½ç›‘æ§å·¥å…·ï¼ˆå¦‚Sentryã€Web Vitalsï¼‰
   - æ·»åŠ å…³é”®æ€§èƒ½æŒ‡æ ‡æ”¶é›†

3. **æ–‡æ¡£**ï¼š
   - ä¸ºè‡ªå®šä¹‰Hooksæ·»åŠ JSDocæ³¨é‡Š
   - ä¸ºå¤æ‚ç»„ä»¶æ·»åŠ ä½¿ç”¨ç¤ºä¾‹

4. **å¯è®¿é—®æ€§**ï¼š
   - æ·»åŠ ARIAæ ‡ç­¾
   - ç¡®ä¿é”®ç›˜å¯¼èˆªæ”¯æŒ
   - ç¡®ä¿å±å¹•é˜…è¯»å™¨æ”¯æŒ

---

## ğŸ“ æ€»ç»“

é¡¹ç›®æ•´ä½“æ¶æ„è‰¯å¥½ï¼Œå·²ç»åšäº†å¾ˆå¤šæ€§èƒ½ä¼˜åŒ–ï¼ˆè·¯ç”±æ‡’åŠ è½½ã€æ•°æ®é‡‡æ ·ç­‰ï¼‰ã€‚ä¸»è¦ä¼˜åŒ–æ–¹å‘æ˜¯ï¼š

1. **ä»£ç å¤ç”¨**ï¼šé€šè¿‡è‡ªå®šä¹‰Hookså‡å°‘é‡å¤ä»£ç 
2. **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†æœºåˆ¶
3. **ç”¨æˆ·ä½“éªŒ**ï¼šä¼˜åŒ–åŠ è½½çŠ¶æ€å’Œé”™è¯¯æç¤º
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šå‡å°‘ä¸å¿…è¦çš„é‡æ¸²æŸ“å’Œè¯·æ±‚

å»ºè®®ä¼˜å…ˆå®æ–½é«˜ä¼˜å…ˆçº§çš„ä¼˜åŒ–é¡¹ï¼Œè¿™äº›æ”¹åŠ¨å½±å“å¤§ã€å·¥ä½œé‡å°ï¼Œèƒ½å¿«é€Ÿæå‡é¡¹ç›®è´¨é‡ã€‚

